---
# defaults for security-related variables

##
## auditd-related variables
##

# larger than normal buffer to handle more messages
security_auditd_buffer_size: 8192

# sets the failure mode to: panic
security_auditd_failure_mode: 2

# enable Kerberos 5 for authentication and encryption
security_auditd_enable_kerberos: no


##
## login-related variables
##

# number of concurrent logins for each user
security_maxlogins: 10

# number of seconds of inactivity before a user is logged out
security_login_timeout: 3600


##
## password-related variables
##

# maximum number of days a password may be used
# (-1 will disable this restriction)
security_password_max_days: -1

# minumum number of days allowed between password changes
# (-1 will disable this restriction)
security_password_min_days: 1

# maximum number of login retries
security_password_max_retries: 3

# maximum amount of time in seconds for the login
security_password_login_timeout: 60

# seconds before being allowed another attempt after a login failure
security_password_fail_delay: 4


##
## PAM-related variables
##
## PAM is an extremely flexible but complicated tool and small changes can
## have drastic consequences, as such this role does little to MODIFY any
## existing PAM configuration but rather backs up and REPLACES the
## configuration with new files.
##
## If you have a custom PAM configuration that cannot be met with the settings
## provided below, you should probably opt to set `security_pam_harden` to `no`
## which will skip any tasks related to configuring PAM.
##

# provide an option to skip the PAM security configuration steps
security_pam_harden: yes


# define the minimum uid used for non-local accounts
security_pam_minimum_uid: 1000

# set this to zero to disable the minimum password length requirement
security_pam_minimum_password_length: 15


# enable account lockouts for too many failed login attempts
security_pam_account_lockouts: yes

# number of failed attempts before the account is locked
security_pam_failed_attempts_max: 25

# number of seconds to wait before automatically unlocking an account
security_pam_account_unlock_time: 900


# allow login credentials to be cached
security_pam_cache_credentials: yes

# include configuration to reference /etc/security/access.conf
#   for host, domain, IP address, or terminal type login restrictions
security_pam_use_login_access_restrictions: no

# include configuration to do authentication against Kerberos
security_pam_use_krb5: no

# include configuration to lookup users/groups with LDAP
security_pam_use_ldap: no


# include configuration to do second-factor authentication with Duo
security_pam_use_duo: no

# use Duo 2FA for local unix accounts
security_pam_duo_local_users: no

# path to the Duo PAM module
security_pam_duo_module_path: /lib64/security/pam_duo.so








##
## SSH-related variables
##

# SSH port to use (default: 22 -- not recommended)
security_sshd_port: 22

# Users allowed to SSH into the server
#   Each entry must have a "name" attribute that specifies the username
#   Each entry can have a "host" attribute
#
#   Example:
#     security_ssh_users:
#       - tom:
#           name: tom
#           host: 192.168.0.*
#       - user2:
#           name: jane
#       - {name: joan, host: 192.168.0.150}
security_ssh_users: []

# Groups allowed to SSH into the server
#   Each entry must have a "name" attribute that specifies the group name
#   Each entry can have a "host" attribute
security_ssh_groups: []

# Users with specific (and limited) SFTP access
#   Each entry must have a "name" attribute that specifies the username
#   The following optional attributes (with their default values) are supported:
#     'chroot' -- specify the chroot jail directory (default: %h/public_html)
#     'x11forwarding' -- is X11 forwarding permitted? (default: no)
#     'allowagentforwarding' -- is ssh-agent forwarding permitted? (default: no)
#     'allowtcpforwarding' -- is TCP forwarding permitted? (default: no)
security_sftp_users: []


##
## sudo-related variables
##

# prevent passwordless sudo use
security_block_passwordless_sudo: no

# list of specific usernames that are allowed unrestricted sudo use
security_sudo_users: []

# list of specific usernames that are allowed unrestricted sudo use
# WITH NO PASSWORD!
# (this should be used VERY sparingly)
security_sudo_nopasswd_users: []

# list of specific groups that are allowed unrestricted sudo use
# (this is discouraged for a more secure system)
security_sudo_groups: []
